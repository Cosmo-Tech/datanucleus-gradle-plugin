plugins {
    id 'java-gradle-plugin'
    id 'maven-publish'
}

group 'org.rm3l'
version '1.0-SNAPSHOT'

ext {
    datanucleusVersion = '5.+'
    javaxJdoVersion = '3.+'
    jpaVersion = '2.+'
    javapoetVersion = '1.11.1'
    junitVersion = '5.3.1'
    junitPioneerVersion = '0.3.0'
}

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile "org.datanucleus:datanucleus-core:${datanucleusVersion}"
    compile "org.datanucleus:javax.jdo:${javaxJdoVersion}"
    compile "org.datanucleus:javax.persistence:${jpaVersion}"
    compile "org.datanucleus:datanucleus-api-jpa:${datanucleusVersion}"
    compile "org.datanucleus:datanucleus-api-jdo:${datanucleusVersion}"

    testCompile gradleTestKit()
    testCompile "org.junit.jupiter:junit-jupiter-api:${junitVersion}"
    testCompile "org.junit-pioneer:junit-pioneer:${junitPioneerVersion}"
    testCompile "com.squareup:javapoet:${javapoetVersion}"
    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:${junitVersion}"
}

test {
    useJUnitPlatform()
    include 'org/rm3l/**/*Test*'
}

gradlePlugin {
    plugins {
        datanucleusPlugin {
            id = 'org.rm3l.datanucleus-gradle-plugin'
            implementationClass = 'org.rm3l.datanucleus.gradle.DataNucleusPlugin'
        }
    }
}

publishing {
    publications {
        pluginPublication (MavenPublication) {
            from    components.java
            groupId    project.group
            artifactId    "datanucleus-gradle-plugin"
            version    project.version
        }
    }
}